const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/OpenCycleMap-D8uhgUsN.js","assets/index-D5qa_RYa.js","assets/index-B4FLi_Cl.css","assets/OpenCycleMap-CIGW-MKW.css","assets/ElevationGraph-CzVXPjjC.js"])))=>i.map(i=>d[i]);
import{j as e,u as re,r as me,a as ee,b as pe,N as he,R as ie,_ as le}from"./index-D5qa_RYa.js";import{u as X}from"./store-DFe219Sd.js";const ge=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 25",fill:"currentColor",className:"h-5 w-5",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})});function fe({waypoint:n,hideMilestoneData:h,Icon:r,lastNode:d=!1}){var m;return e.jsxs("li",{style:{marginBottom:"-4pt"},children:[e.jsx("div",{className:"timeline-middle",children:r}),e.jsxs("div",{className:"timeline-end text-left flex flex-row gap-x-2 px-2 pt-2 m-0",children:[h?e.jsx(e.Fragment,{}):e.jsx("time",{className:"flex-none w-10",children:n.milestone>=1e3?`${(n.milestone/1e3).toFixed(0)}km`:"Start"}),e.jsxs("div",{className:"grow text-lg leading-tight",children:[e.jsx("span",{className:"font-bold",children:n.name}),(m=n.description)==null?void 0:m.split("<br>").map((c,g)=>e.jsx("p",{children:c},n.coordinates.toString()+g))]})]}),d?e.jsx(e.Fragment,{}):e.jsx("hr",{style:{zIndex:"-500",marginTop:"2pt",height:"110%"}})]})}function xe({waypoints:n,styles:h}){const r=n.filter(d=>d.milestone>1e3).length<=0;return e.jsx("ul",{className:"timeline timeline-vertical timeline-snap-icon timeline-compact",children:n.sort((d,m)=>d.milestone_index-m.milestone_index).map((d,m,c)=>{let g=e.jsx(ge,{});const j=`${d.style}-normal`;return j in h&&(g=e.jsx("img",{src:h[j].iconUrl,width:25,height:25})),e.jsx(fe,{waypoint:d,hideMilestoneData:r,Icon:g,lastNode:m+1>=c.length},d.coordinates.toString())})})}function be({folder:n,selectedId:h}){const r=re(),d=X(m=>m.kml.folders.map(c=>c.name));return e.jsxs("div",{className:"dropdown dropdown-end w-full",children:[e.jsx("div",{tabIndex:0,role:"button",className:"btn h-auto w-full bg-transparent justify-start text-start p-2 m-0 mb-2 print:p-0 print:pl-2 print:border-none print:shadow-none",children:e.jsx("p",{className:"text-2xl font-bold",children:n.name})}),e.jsx("ul",{tabIndex:0,className:"dropdown-content z-1 menu p-2 bg-base-100 rounded-box w-full",children:d.map((m,c)=>e.jsx("li",{children:e.jsx("a",{onClick:()=>r(`/folder/${c}`),className:h===c?"font-bold":"",children:m})},m))})]})}const ve={background:"bg-white"},ye={background:"bg-white"},G="badge py-2 px-2 text-md",je=n=>{let h="";const r=Math.floor(n/60/60);h+=r+"h";const d=Math.floor(n/60-r*60);return h+=" "+d+"m",h},we=({path:n,theme:h})=>{let r=ye;return h=="light"&&(r=ve),!n||(n==null?void 0:n.statistics.total_distance)<1e3?e.jsx(e.Fragment,{}):e.jsxs("div",{className:"badges flex-wrap w-full text-left print:text-start space-x-1",children:[n!=null&&n.statistics.duration&&(n==null?void 0:n.statistics.duration)>300?e.jsx("div",{className:"tooltip tooltip-bottom","data-tip":"Fahrtdauer",children:e.jsxs("div",{className:`${G} ${r.background}`,children:[e.jsx("i",{className:"fa-solid fa-clock"}),e.jsx("span",{children:je(n==null?void 0:n.statistics.duration)})]})}):e.jsx(e.Fragment,{}),e.jsx("div",{className:"tooltip tooltip-bottom","data-tip":"Distanz",children:e.jsxs("div",{className:`${G} ${r.background}`,children:[e.jsx("i",{className:"fa-solid fa-road"}),e.jsxs("span",{children:[((n==null?void 0:n.statistics.total_distance)/1e3).toFixed(1)," km"]})]})}),e.jsx("div",{className:"tooltip tooltip-bottom","data-tip":"ø Geschindigkeit",children:e.jsxs("div",{className:`${G} ${r.background}`,children:[e.jsx("i",{className:"fa-solid fa-gauge-high"}),e.jsxs("span",{children:[(n==null?void 0:n.statistics.speed).toFixed(1)," km/h"]})]})}),e.jsx("div",{className:"tooltip tooltip-bottom","data-tip":"Höhenmeter (Anstieg)",children:e.jsxs("div",{className:`${G} ${r.background}`,children:[e.jsx("i",{className:"fa-solid fa-up-long"}),e.jsxs("span",{children:[n==null?void 0:n.statistics.climb.toFixed(0)," m"]})]})}),e.jsx("div",{className:"tooltip tooltip-bottom","data-tip":"Höhenmeter (Abstieg)",children:e.jsxs("div",{className:`${G} ${r.background}`,children:[e.jsx("i",{className:"fa-solid fa-down-long"}),e.jsxs("span",{children:[n==null?void 0:n.statistics.fall.toFixed(0)," m"]})]})}),e.jsx("div",{className:"tooltip tooltip-bottom","data-tip":"Maximale Steigung",children:e.jsxs("div",{className:`${G} ${r.background}`,children:[e.jsx("i",{className:"fa-solid fa-hill-rockslide"}),e.jsxs("span",{children:[((n==null?void 0:n.statistics.max_gradient)*100).toFixed(0)," %"]})]})})]})};var Q={exports:{}},Ne=Q.exports,oe;function Ee(){return oe||(oe=1,function(n,h){(function(r,d){n.exports=d(me())})(typeof self<"u"?self:Ne,function(r){return function(){var d={155:function(t){t.exports=r}},m={};function c(t){var s=m[t];if(s!==void 0)return s.exports;var a=m[t]={exports:{}};return d[t](a,a.exports,c),a.exports}c.d=function(t,s){for(var a in s)c.o(s,a)&&!c.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:s[a]})},c.o=function(t,s){return Object.prototype.hasOwnProperty.call(t,s)},c.r=function(t){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var g={};c.r(g),c.d(g,{useReactToPrint:function(){return de}});var j=c(155);function b({level:t="error",messages:s,suppressErrors:a=!1}){a||(t==="error"?console.error(s):t==="warning"?console.warn(s):console.debug(s))}function H(t,s){if(s||!t){const a=document.getElementById("printWindow");a&&document.body.removeChild(a)}}function V(t){return t instanceof Error?t:new Error("Unknown Error")}function te(t,s){const{documentTitle:a,onAfterPrint:v,onPrintError:E,preserveAfterPrint:N,print:C,suppressErrors:k}=s;setTimeout(()=>{var y,w;if(t.contentWindow){let I=function(){v==null||v(),H(N)};if(t.contentWindow.focus(),C)C(t).then(I).catch(T=>{E?E("print",V(T)):b({messages:["An error was thrown by the specified `print` function"],suppressErrors:k})});else{if(t.contentWindow.print){const T=(w=(y=t.contentDocument)===null||y===void 0?void 0:y.title)!==null&&w!==void 0?w:"",P=t.ownerDocument.title;a&&(t.ownerDocument.title=a,t.contentDocument&&(t.contentDocument.title=a)),t.contentWindow.print(),a&&(t.ownerDocument.title=P,t.contentDocument&&(t.contentDocument.title=T))}else b({messages:["Printing for this browser is not currently possible: the browser does not have a `print` method available for iframes."],suppressErrors:k});[/Android/i,/webOS/i,/iPhone/i,/iPad/i,/iPod/i,/BlackBerry/i,/Windows Phone/i].some(T=>{var P,F;return((F=(P=navigator.userAgent)!==null&&P!==void 0?P:navigator.vendor)!==null&&F!==void 0?F:"opera"in window&&window.opera).match(T)})?setTimeout(I,500):I()}}else b({messages:["Printing failed because the `contentWindow` of the print iframe did not load. This is possibly an error with `react-to-print`. Please file an issue: https://github.com/MatthewHerbst/react-to-print/issues/"],suppressErrors:k})},500)}function ne(t){const s=[],a=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,null);let v=a.nextNode();for(;v;)s.push(v),v=a.nextNode();return s}function se(t,s,a){const v=ne(t),E=ne(s);if(v.length===E.length)for(let N=0;N<v.length;N++){const C=v[N],k=E[N],y=C.shadowRoot;if(y!==null){const w=k.attachShadow({mode:y.mode});w.innerHTML=y.innerHTML,se(y,w,a)}}else b({messages:["When cloning shadow root content, source and target elements have different size. `onBeforePrint` likely resolved too early.",t,s],suppressErrors:a})}const ae=`
    @page {
        /* Remove browser default header (title) and footer (url) */
        margin: 0;
    }
    @media print {
        body {
            /* Tell browsers to print background colors */
            color-adjust: exact; /* Firefox. This is an older version of "print-color-adjust" */
            print-color-adjust: exact; /* Firefox/Safari */
            -webkit-print-color-adjust: exact; /* Chrome/Safari/Edge/Opera */
        }
    }
`;function ce(t,s,a,v){var E,N,C,k,y;const{contentNode:w,clonedContentNode:I,clonedImgNodes:T,clonedVideoNodes:P,numResourcesToLoad:F,originalCanvasNodes:K}=a,{bodyClass:U,fonts:D,ignoreGlobalStyles:Y,pageStyle:z,nonce:$,suppressErrors:u,copyShadowRoots:q}=v;t.onload=null;const p=(E=t.contentDocument)!==null&&E!==void 0?E:(N=t.contentWindow)===null||N===void 0?void 0:N.document;if(p){const W=p.body.appendChild(I);q&&se(w,W,!!u),D&&(!((C=t.contentDocument)===null||C===void 0)&&C.fonts&&(!((k=t.contentWindow)===null||k===void 0)&&k.FontFace)?D.forEach(i=>{const o=new FontFace(i.family,i.source,{weight:i.weight,style:i.style});t.contentDocument.fonts.add(o),o.loaded.then(()=>{s(o)}).catch(x=>{s(o,["Failed loading the font:",o,"Load error:",V(x)])})}):(D.forEach(i=>{s(i)}),b({messages:['"react-to-print" is not able to load custom fonts because the browser does not support the FontFace API but will continue attempting to print the page'],suppressErrors:u})));const B=z??ae,L=p.createElement("style");$&&(L.setAttribute("nonce",$),p.head.setAttribute("nonce",$)),L.appendChild(p.createTextNode(B)),p.head.appendChild(L),U&&p.body.classList.add(...U.split(" "));const R=p.querySelectorAll("canvas");for(let i=0;i<K.length;++i){const o=K[i],x=R[i];if(x===void 0){b({messages:["A canvas element could not be copied for printing, has it loaded? `onBeforePrint` likely resolved too early.",o],suppressErrors:u});continue}const l=x.getContext("2d");l&&l.drawImage(o,0,0)}for(let i=0;i<T.length;i++){const o=T[i],x=o.getAttribute("src");if(x){const l=new Image;l.onload=()=>{s(o)},l.onerror=(f,S,O,A,M)=>{s(o,["Error loading <img>",o,"Error",M])},l.src=x}else s(o,['Found an <img> tag with an empty "src" attribute. This prevents pre-loading it.',o])}for(let i=0;i<P.length;i++){const o=P[i];o.preload="auto";const x=o.getAttribute("poster");if(x){const l=new Image;l.onload=()=>{s(o)},l.onerror=(f,S,O,A,M)=>{s(o,["Error loading video poster",x,"for video",o,"Error:",M])},l.src=x}else o.readyState>=2?s(o):o.src?(o.onloadeddata=()=>{s(o)},o.onerror=(l,f,S,O,A)=>{s(o,["Error loading video",o,"Error",A])},o.onstalled=()=>{s(o,["Loading video stalled, skipping",o])}):s(o,["Error loading video, `src` is empty",o])}const _="select",Z=w.querySelectorAll(_),J=p.querySelectorAll(_);for(let i=0;i<Z.length;i++)J[i].value=Z[i].value;if(!Y){const i=document.querySelectorAll("style, link[rel~='stylesheet'], link[as='style']");for(let o=0,x=i.length;o<x;++o){const l=i[o];if(l.tagName.toLowerCase()==="style"){const f=p.createElement(l.tagName),S=l.sheet;if(S){let O="";try{const A=S.cssRules.length;for(let M=0;M<A;++M)typeof S.cssRules[M].cssText=="string"&&(O+=`${S.cssRules[M].cssText}\r
`)}catch(A){b({messages:["A stylesheet could not be accessed. This is likely due to the stylesheet having cross-origin imports, and many browsers block script access to cross-origin stylesheets. See https://github.com/MatthewHerbst/react-to-print/issues/429 for details. You may be able to load the sheet by both marking the stylesheet with the cross `crossorigin` attribute, and setting the `Access-Control-Allow-Origin` header on the server serving the stylesheet. Alternatively, host the stylesheet on your domain to avoid this issue entirely.",l,`Original error: ${V(A).message}`],level:"warning"})}f.setAttribute("id",`react-to-print-${o}`),$&&f.setAttribute("nonce",$),f.appendChild(p.createTextNode(O)),p.head.appendChild(f)}}else if(l.getAttribute("href"))if(l.hasAttribute("disabled"))b({messages:["`react-to-print` encountered a <link> tag with a `disabled` attribute and will ignore it. Note that the `disabled` attribute is deprecated, and some browsers ignore it. You should stop using it. https://developer.mozilla.org/en-US/docs/Web/HTML/Element/link#attr-disabled. The <link> is:",l],level:"warning"}),s(l);else{const f=p.createElement(l.tagName);for(let S=0,O=l.attributes.length;S<O;++S){const A=l.attributes[S];A&&f.setAttribute(A.nodeName,(y=A.nodeValue)!==null&&y!==void 0?y:"")}f.onload=()=>{s(f)},f.onerror=(S,O,A,M,ue)=>{s(f,["Failed to load",f,"Error:",ue])},$&&f.setAttribute("nonce",$),p.head.appendChild(f)}else b({messages:["`react-to-print` encountered a <link> tag with an empty `href` attribute. In addition to being invalid HTML, this can cause problems in many browsers, and so the <link> was not loaded. The <link> is:",l],level:"warning"}),s(l)}}}F===0&&te(t,v)}function de({bodyClass:t,contentRef:s,copyShadowRoots:a,documentTitle:v,fonts:E,ignoreGlobalStyles:N,nonce:C,onAfterPrint:k,onBeforePrint:y,onPrintError:w,pageStyle:I,preserveAfterPrint:T,print:P,suppressErrors:F}){return(0,j.useCallback)(K=>{function U(){const D={bodyClass:t,contentRef:s,copyShadowRoots:a,documentTitle:v,fonts:E,ignoreGlobalStyles:N,nonce:C,onAfterPrint:k,onPrintError:w,pageStyle:I,preserveAfterPrint:T,print:P,suppressErrors:F},Y=function(){const u=document.createElement("iframe");return u.width=`${document.documentElement.clientWidth}px`,u.height=`${document.documentElement.clientHeight}px`,u.style.position="absolute",u.style.top=`-${document.documentElement.clientHeight+100}px`,u.style.left=`-${document.documentElement.clientWidth+100}px`,u.id="printWindow",u.srcdoc="<!DOCTYPE html>",u}(),z=function(u,q){const{contentRef:p,fonts:W,ignoreGlobalStyles:B,suppressErrors:L}=q,R=function({contentRef:x,optionalContent:l,suppressErrors:f}){return!l||l instanceof Event||(x&&b({level:"warning",messages:['"react-to-print" received a `contentRef` option and a optional-content param passed to its callback. The `contentRef` option will be ignored.']}),typeof l!="function")?x?x.current:void b({messages:['"react-to-print" did not receive a `contentRef` option or a optional-content param pass to its callback.'],suppressErrors:f}):l()}({contentRef:p,optionalContent:u,suppressErrors:L});if(!R)return;const _=R.cloneNode(!0),Z=document.querySelectorAll("link[rel~='stylesheet'], link[as='style']"),J=_.querySelectorAll("img"),i=_.querySelectorAll("video"),o=W?W.length:0;return{contentNode:R,clonedContentNode:_,clonedImgNodes:J,clonedVideoNodes:i,numResourcesToLoad:(B?0:Z.length)+J.length+i.length+o,originalCanvasNodes:R.querySelectorAll("canvas")}}(K,D);if(!z)return void b({messages:["There is nothing to print"],suppressErrors:F});const $=function(u,q,p){const{suppressErrors:W}=u,B=[],L=[];return function(R,_){B.includes(R)?b({level:"debug",messages:["Tried to mark a resource that has already been handled",R],suppressErrors:W}):(_?(b({messages:['"react-to-print" was unable to load a resource but will continue attempting to print the page',..._],suppressErrors:W}),L.push(R)):B.push(R),B.length+L.length===q&&te(p,u))}}(D,z.numResourcesToLoad,Y);(function(u,q,p,W){u.onload=()=>{ce(u,q,p,W)},document.body.appendChild(u)})(Y,$,z,D)}H(T,!0),y?y().then(()=>{U()}).catch(D=>{w==null||w("onBeforePrint",V(D))}):U()},[t,s,a,v,E,N,C,k,y,w,I,T,P,F])}return g}()})}(Q)),Q.exports}var ke=Ee();const Te=[{name:"Atlas",icon:"🧭",tileType:"atlas"},{name:"Stadt",icon:"🏠",tileType:"neighbourhood"},{name:"Topographie",icon:"🏔️",tileType:"landscape",divider:!0},{name:"Wandern",icon:"🥾",tileType:"outdoors"},{name:"Fahrrad",icon:"🚴",tileType:"cycle",divider:!0},{name:"Kontrast",icon:"🐼",tileType:"mobile-atlas"}];function Se({printRef:n}){const[h,r,d]=X(j=>[j.settings,j.setMapTileType,j.toggleElevationChart]),m=re(),c=ke.useReactToPrint({contentRef:n}),g=ee.useRef(null);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`dropdown dropdown-top dropdown-end 
                    absolute bottom-5 right-5 
                    print:hidden`,children:[e.jsxs("div",{className:"join",children:[e.jsxs("a",{className:"btn join-item border-0",onClick:c,children:[e.jsx("i",{className:"fa-solid fa-print"}),"Drucken"]}),e.jsx("div",{tabIndex:1,role:"button",className:"btn btn-square join-item",children:e.jsx("i",{className:"fa-solid fa-gear"})})]}),e.jsxs("ul",{tabIndex:1,className:"dropdown-content menu w-52 bg-base-100 rounded-box border-primary-content border-1 shadow-md",children:[e.jsxs("button",{className:"btn btn-neutral justify-start",onClick:()=>{var j;return(j=g.current)==null?void 0:j.showModal()},children:[e.jsx("i",{className:"fa-solid fa-upload"}),"Neue Tour laden"]}),e.jsx("h2",{className:"menu-title text-primary-content",children:"Darstellung"}),e.jsx("li",{children:e.jsxs("label",{className:"label cursor-pointer text-primary-content space-x-1",children:[e.jsx("input",{type:"checkbox",className:"toggle",defaultChecked:!0,onChange:()=>d()}),e.jsx("p",{children:"Höhenprofil"})]})},"elevationChart"),e.jsx("h2",{className:"menu-title text-primary-content",children:"Kartentyp"}),Te.map(({name:j,icon:b,tileType:H,divider:V})=>e.jsx("li",{onClick:()=>r(H),children:e.jsxs("a",{className:"space-x-1 "+(h.mapTileType===H?"menu-active":""),children:[e.jsx("span",{children:b}),e.jsx("span",{children:j})]})},H))]})]}),e.jsx("dialog",{ref:g,className:"modal",children:e.jsxs("div",{className:"modal-box",children:[e.jsx("h3",{className:"text-lg font-bold",children:"Achtung!"}),e.jsx("p",{className:"py-4",children:"Willst du eine neue .kml Datei laden und die Kartenansicht verlassen? Deine Einstellungen für die Darstellung bleiben erhalten, aber Touren und Wegpunkte werden neu geladen."}),e.jsxs("div",{className:"modal-action",children:[e.jsxs("button",{className:"btn btn-primary",onClick:()=>m("/"),children:[e.jsx("i",{className:"fa-solid fa-upload"}),"Neue Datei laden"]}),e.jsx("form",{method:"dialog",children:e.jsx("button",{className:"btn",children:"Zurück"})})]})]})})]})}const Ae=ie.lazy(()=>le(()=>import("./OpenCycleMap-D8uhgUsN.js"),__vite__mapDeps([0,1,2,3]))),Ce=ie.lazy(()=>le(()=>import("./ElevationGraph-CzVXPjjC.js"),__vite__mapDeps([4,1,2])));function Fe(){const{folderId:n}=pe(),h=X(g=>g.settings),[r,d,m]=X(g=>g.kml?[g.kml.folders[Number(n)],g.kml.folders.map(j=>j.path),g.kml.styles]:[void 0,void 0,void 0]),c=ee.useRef(null);return r?e.jsxs("div",{className:"grid grid-cols-2 print:grid-cols-1 gap-0 h-screen",children:[e.jsx("div",{className:"print:hidden grid-1",children:e.jsx(ee.Suspense,{fallback:e.jsx("div",{className:"grid content-center justify-center",children:e.jsx("span",{className:"loading loading-ring loading-lg content-center align-middle"})}),children:e.jsx(Ae,{folder:r,paths:d,selectedWaypoint:r.waypoints[0],selectedMapTileType:h.mapTileType,styles:m})})}),e.jsxs("div",{ref:c,className:"grid-1 p-5 overflow-x-auto print:overflow-x-visible",children:[e.jsxs("div",{className:"m-0 mb-2 justify-start text-start",children:[e.jsx(be,{folder:r,selectedId:Number(n)}),e.jsx(we,{path:r.path,theme:"light"})]}),r.path&&h.elevationChartVisible?e.jsx("div",{className:"h-40 w-full",children:e.jsx(Ce,{path:r.path,waypoints:r.waypoints,styles:m})}):e.jsx(e.Fragment,{}),e.jsx("div",{className:"print:ml-2",children:e.jsx(xe,{waypoints:r.waypoints,styles:m})})]}),e.jsx(Se,{printRef:c})]}):e.jsx(he,{to:"/"})}export{Fe as default};
